{"version":3,"sources":["Components/Patient/ShowPatients.js"],"names":["ShowPatients","currentUser","useAuth","patients","setPatients","useState","searchInput","setSearchInput","progress","setProgress","currentPage","setCurrentPage","error","setError","success","setSuccess","navigate","useNavigate","useEffect","async","currentUserData","getDocs","collection","db","docs","find","doc","data","email","cfPazienti","pazienti","patientsData","cf","patientQuery","query","where","patientSnapshot","empty","patientData","push","console","message","log","getPatients","filtered","filter","patient","toLowerCase","nome","includes","cognome","cf_paz","_jsx","Spinner","_Fragment","children","Container","className","style","background","backgroundSize","minHeight","padding","marginTop","_jsxs","Card","marginBottom","borderRadius","boxShadow","borderLeft","borderTop","fontFamily","marginLeft","LinkContainer","to","Button","height","width","variant","FontAwesomeIcon","icon","faAngleLeft","color","Alert","margin","onClose","dismissible","SyncLoader","loading","position","top","left","transform","zIndex","ListGroup","Navbar","expand","InputGroup","Form","Control","type","placeholder","value","onChange","e","target","onClick","replace","faPlus","marginRight","map","PatientPreview","id","nomePaziente","cognomePaziente","codiceFiscalePaziente","length","Pagination","itemsCount","itemsPerPage","alwaysShown"],"mappings":"iHAAA,iOAee,SAASA,IACtB,MAAM,YAAEC,GAAgBC,eACjBC,EAAUC,GAAeC,mBAAS,KAClCC,EAAaC,GAAkBF,mBAAS,KACxCG,EAAUC,GAAeJ,oBAAS,IAElCK,EAAaC,GAAkBN,mBAAS,IACxCO,EAAOC,GAAYR,mBAAS,KAC5BS,EAASC,GAAcV,mBAAS,IACjCW,EAAWC,cACjBC,qBAAU,KACYC,WAClBV,GAAY,GAEZ,IACE,MACMW,SADsBC,YAAQC,YAAWC,IAAI,WACbC,KAAKC,MAAMC,GAAQA,EAAIC,OAAOC,QAAU3B,EAAY2B,QAE1F,GAAIR,EAAiB,CACnB,MACMS,EADgBT,EAAgBO,OACLG,UAAY,GAEvCC,EAAe,GAErB,IAAK,MAAMC,KAAMH,EAAY,CAC3B,MAAMI,EAAeC,YAAMZ,YAAWC,IAAI,SAAUY,YAAM,SAAU,KAAMH,IAC1ErB,EAAe,GACf,IACE,MAAMyB,QAAwBf,YAAQY,GAEtC,IAAKG,EAAgBC,MAAO,CAC1B,MAAMC,EAAcF,EAAgBZ,KAAK,GAAGG,OAC5CI,EAAaQ,KAAKD,EACpB,CACF,CAAE,MAAO1B,GACP4B,QAAQ5B,MAAM,wCAAyCA,EAAM6B,QAC/D,CACF,CAEArC,EAAY2B,EACd,MACES,QAAQE,IAAI,oDAEhB,CAAE,MAAO9B,GACP4B,QAAQ5B,MAAM,wCAAyCA,EAAM6B,QAC/D,CAEAhC,GAAY,EAAM,EAGpBkC,EAAa,GACZ,CAAC1C,IAEJ,MAAM2C,EAAWzC,EAAS0C,QACvBC,GAC+B,KAA9BxC,EAAYyC,eACZD,EAAQE,KAAKD,cAAcE,SAAS3C,EAAYyC,gBAChDD,EAAQI,QAAQH,cAAcE,SAAS3C,EAAYyC,gBACnDD,EAAQK,OAAOJ,cAAcE,SAAS3C,EAAYyC,iBAEtD,OAAiB,IAAbvC,EACK4C,cAACC,IAAO,IAGfD,cAAAE,WAAA,CAAAC,UACgB,IAAb/C,GACC4C,cAACI,IAAS,CAACC,UAAW,mBACtBC,MAAO,CACLC,WAAY,iGACZC,eAAgB,QAChBC,UAAW,UACXC,QAAS,GACXP,SACEH,cAACI,IAAS,CAACC,UAAW,+BAA+BF,SACrDH,cAACI,IAAS,CAACC,UAAW,qCACZC,MAAO,CAACG,UAAW,IAAKE,UAAW,IAAIR,SAC/CS,eAACC,IAAI,CAACR,UAAW,2BACXC,MAAO,CACLK,UAAW,GACXG,aAAc,GACdC,aAAc,GACdC,UAAW,oCACXC,WAAY,kCACZC,UAAW,mCACbf,SAAA,CAEJH,cAAA,MAAIM,MAAO,CAACa,WAAY,QAASR,UAAW,IAAIR,SAAC,oBACjDH,cAAA,OAAKK,UAAW,wBAAwBF,SAClBH,cAAA,OAAKK,UAAW,SAASF,SACrBH,cAAA,OAAKK,UAAW,cACXC,MAAO,CAACK,UAAW,GAAIS,WAAY,IAAIjB,SACxCH,cAACqB,gBAAa,CAACC,GAAG,aACHjB,UAAW,UAAUF,SAChCH,cAACuB,IAAM,CAACjB,MAAO,CAACkB,OAAQ,GAAIC,MAAO,KAC3BC,QAAS,UAAUvB,SAC1BH,cAAC2B,IAAe,CAACC,KAAMC,IACNC,MAAO,oBAKxCtE,IAAUT,GAAYiD,cAAC+B,IAAK,CAACL,QAAQ,SAAQvB,SAAE3C,IACnDE,GAAWsC,cAAC+B,IAAK,CAACzB,MAAO,CAAC0B,OAAQ,IAChBN,QAAQ,UACRO,QAASA,IAAMtE,GAAW,GAC1BuE,aAAa,EAAK/B,SAAEzC,IACrDsC,cAACmC,IAAU,CAACL,MAAM,UAAUM,QAAShF,EACzBkD,MAAO,CACL+B,SAAU,WACVC,IAAK,MACLC,KAAM,MACNC,UAAW,wBACXC,OAAQ,KAEtBzC,cAACI,IAAS,CAACE,MAAO,CAACG,UAAW,KAAKN,SACnCS,eAAC8B,IAAS,CAACrC,UAAW,kCACOC,MAAO,CACHQ,aAAc,IAChBX,SAAA,CAC3BH,cAAC2C,IAAM,CAACC,OAAO,KACPvC,UAAW,yBAAyBF,SACxCS,eAACR,IAAS,CAACC,UAAW,SAASF,SAAA,CAC3BH,cAACI,IAAS,CAACC,UAAW,kBACVC,MAAO,CAACQ,aAAc,IAAIX,SAClCH,cAAC6C,IAAU,CAACxC,UAAU,SAAQF,SAC1BH,cAAC8C,IAAKC,QAAO,CACTC,KAAK,SACLC,YAAa,WACb5C,UAAW,OACX,aAAW,SACX6C,MAAOhG,EACPiG,SAAWC,IACP7F,EAAe,GACfJ,EAAeiG,EAAEC,OAAOH,MAAM,QAM9ClD,cAACI,IAAS,CAACC,UAAW,gCACVC,MAAO,CAACQ,aAAc,GAAIJ,QAAS,GAAGP,SAC9CS,eAACW,IAAM,CAACG,QAAQ,iBACRrB,UAAW,YACXiD,QAASA,IAAM1F,EAAS,sBAAuB,CAAC2F,SAAS,IAAOpD,SAAA,CAACH,cAAC2B,IAAe,CAACC,KAAM4B,IACdlD,MAAO,CAACmD,YAAa,KAAK,+BAKvHjE,EAASkE,KAAKhE,GACfM,cAAC2D,IAAc,CAEbC,GAAIlE,EAAQkE,GACZC,aAAcnE,EAAQE,KACtBkE,gBAAiBpE,EAAQI,QACzBiE,sBAAuBrE,EAAQK,QAJ1BL,EAAQlB,SAOK,IAApBzB,EAASiH,SAAiB5G,GAAY4C,cAAC+B,IAAK,CAACL,QAAS,UAAUvB,SAAC,4CAC9C,IAApBX,EAASwE,QAAgBjH,EAASiH,OAAS,IAAM5G,GAChD4C,cAAC+B,IAAK,CAACL,QAAS,UAAUvB,SAAC,yDAI/BH,cAACI,IAAS,CAACC,UAAW,kDAAkDF,SACjC,IAApBpD,EAASiH,QAAgBhE,cAACiE,IAAU,CACjCC,WAAY1E,EAASwE,OACrBG,aAlKV,GAmKU7G,YAAaA,EACbC,eAAgBA,EAChB6G,aAAa,gBAUjD,C","file":"static/js/31.2620dba0.chunk.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Alert, Button, Card, Form, InputGroup, ListGroup, Navbar } from \"react-bootstrap\";\nimport Container from \"react-bootstrap/Container\";\nimport {useLocation, useNavigate} from \"react-router-dom\";\nimport { collection, getDocs, query, where } from \"firebase/firestore\";\nimport { db } from \"../../config/firebase-config\";\nimport { useAuth } from \"../../context/AuthContext\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { LinkContainer } from \"react-router-bootstrap\";\nimport PatientPreview from \"../Progress/PatientPreview\";\nimport { SyncLoader } from \"react-spinners\";\nimport Pagination from \"../Utilities/Pagination\";\nimport Spinner from \"../Utilities/Spinner\";\nimport {faAngleLeft, faPlus} from \"@fortawesome/free-solid-svg-icons\";\n\nexport default function ShowPatients() {\n  const { currentUser } = useAuth();\n  const [patients, setPatients] = useState([]);\n  const [searchInput, setSearchInput] = useState(\"\");\n  const [progress, setProgress] = useState(true);\n  const patientsPerPage = 10;\n  const [currentPage, setCurrentPage] = useState(1);\n  const [error, setError] = useState(\"\");\n  const [success, setSuccess] = useState(\"\");\n  const navigate = useNavigate();\n  useEffect(() => {\n    const getPatients = async () => {\n      setProgress(true);\n\n      try {\n        const querySnapshot = await getDocs(collection(db, \"users\"));\n        const currentUserData = querySnapshot.docs.find((doc) => doc.data().email === currentUser.email);\n\n        if (currentUserData) {\n          const nutrizionista = currentUserData.data();\n          const cfPazienti = nutrizionista.pazienti || [];\n\n          const patientsData = [];\n\n          for (const cf of cfPazienti) {\n            const patientQuery = query(collection(db, \"users\"), where(\"cf_paz\", \"==\", cf));\n            setCurrentPage(1);\n            try {\n              const patientSnapshot = await getDocs(patientQuery);\n\n              if (!patientSnapshot.empty) {\n                const patientData = patientSnapshot.docs[0].data();\n                patientsData.push(patientData);\n              } \n            } catch (error) {\n              console.error(\"Errore durante la query del paziente:\", error.message);\n            }\n          }\n\n          setPatients(patientsData);\n        } else {\n          console.log(\"Nessun nutrizionista trovato con l'email corrente\");\n        }\n      } catch (error) {\n        console.error(\"Errore durante la query degli utenti:\", error.message);\n      }\n\n      setProgress(false);\n    };\n\n    getPatients();\n  }, [currentUser]);\n\n  const filtered = patients.filter(\n    (patient) =>\n      searchInput.toLowerCase() === \"\" ||\n      patient.nome.toLowerCase().includes(searchInput.toLowerCase()) ||\n      patient.cognome.toLowerCase().includes(searchInput.toLowerCase()) ||\n      patient.cf_paz.toLowerCase().includes(searchInput.toLowerCase())\n  );\n  if (progress === true) {\n    return <Spinner/>;\n}\n  return (\n    <>\n      {progress === false && (\n        <Container className={\"modal-fullscreen\"}\n        style={{\n          background: \"linear-gradient(123deg, rgba(247,209,98,1) 30%, rgba(251,149,96,1) 50%, rgba(254,88,94,1) 70%)\",\n          backgroundSize: \"cover\",\n          minHeight: \"inherit\",\n          padding: 0\n      }}>\n          <Container className={\"modal-fullscreen text-center\"}>\n          <Container className={\"d-flex flex-column mx-auto my-auto\"}\n                    style={{minHeight: 450, marginTop: 20}}>\n            <Card className={\"col-12 col-md-10 mx-auto\"}\n                  style={{\n                    marginTop: 20,\n                    marginBottom: 20,\n                    borderRadius: 16,\n                    boxShadow: \"10px 10px 10px rgba(30,30,30,0.5)\",\n                    borderLeft: \"solid 1px rgba(255,255,255,0.8)\",\n                    borderTop: \"solid 1px rgba(255,255,255,0.8)\"\n                }}>\n                \n              <h2 style={{fontFamily: \"Arial\", marginTop: 10}}>I tuoi pazienti</h2>\n              <div className={\"d-flex my-auto col-12\"}>\n                                    <div className={\"col-12\"}>\n                                        <div className={\"float-start\"}\n                                             style={{marginTop: 10, marginLeft: 20}}>\n                                            <LinkContainer to=\"/dashboard\"\n                                                           className={\"my-auto\"}>\n                                                <Button style={{height: 40, width: 100}}\n                                                        variant={\"warning\"}\n                                                ><FontAwesomeIcon icon={faAngleLeft}\n                                                                  color={\"black\"}/></Button>\n                                            </LinkContainer>\n                                        </div>\n                                    </div>\n                                </div>\n                                {error && !patients && <Alert variant=\"danger\">{error}</Alert>}\n                            {success && <Alert style={{margin: 20}}\n                                               variant=\"primary\"\n                                               onClose={() => setSuccess(false)}\n                                               dismissible={true}>{success}</Alert>}\n              <SyncLoader color=\"#eb6164\" loading={progress} \n                          style={{\n                            position: \"absolute\",\n                            top: \"50%\",\n                            left: \"50%\",\n                            transform: \"translate(-50%, -50%)\",\n                            zIndex: 1\n                        }}/>\n              <Container style={{minHeight: 500}}>\n              <ListGroup className={\"d-flex col-12 col-md-12 mx-auto\"}\n                                           style={{\n                                               marginBottom: 20\n                                           }}>\n                  <Navbar expand=\"lg\"\n                          className={\"justify-content-evenly\"}>\n                      <Container className={\"col-12\"}>\n                          <Container className={\"col-12 col-md-6\"}\n                                      style={{marginBottom: 10}}>\n                              <InputGroup className=\"d-flex\">\n                                  <Form.Control\n                                      type=\"search\"\n                                      placeholder={\"Cerca...\"}\n                                      className={\"me-2\"}\n                                      aria-label=\"Search\"\n                                      value={searchInput}\n                                      onChange={(e) => {\n                                          setCurrentPage(1);\n                                          setSearchInput(e.target.value);\n                                      }}\n                                  />\n                              </InputGroup>\n                          </Container>\n                         \n                          <Container className={\"col-6 col-md-3 d-inline-block\"}\n                                      style={{marginBottom: 10, padding: 0}}>\n                              <Button variant=\"outline-danger\"\n                                      className={\"flex-wrap\"}\n                                      onClick={() => navigate(\"/inserisci-paziente\", {replace: true})}><FontAwesomeIcon icon={faPlus}\n                                                                                                                style={{marginRight: 5}}/>Inserisci paziente</Button>\n\n                          </Container>\n                      </Container>\n                  </Navbar>\n                  {filtered.map((patient) => (\n                  <PatientPreview\n                    key={patient.email}\n                    id={patient.id}\n                    nomePaziente={patient.nome}\n                    cognomePaziente={patient.cognome}\n                    codiceFiscalePaziente={patient.cf_paz}\n                  />\n                ))}\n                 {patients.length === 0 && !progress && <Alert variant={\"warning\"}>Non hai inserito ancora nessun paziente</Alert>}\n                {filtered.length === 0 && patients.length > 0 && !progress && (\n                  <Alert variant={\"warning\"}>Nessun paziente soddisfa i parametri di ricerca</Alert>\n                )}\n              </ListGroup>\n              </Container>\n              <Container className={\"d-flex flex-wrap justify-content-center mt-auto\"}>\n                                {patients.length !== 0 && <Pagination\n                                    itemsCount={filtered.length}\n                                    itemsPerPage={patientsPerPage}\n                                    currentPage={currentPage}\n                                    setCurrentPage={setCurrentPage}\n                                    alwaysShown={true}\n                                />}\n              </Container>\n            </Card>\n            </Container>\n          </Container>\n        </Container>\n      )}\n    </>\n  );\n}\n"],"sourceRoot":""}